@startuml

entity tactics {
  * tactic_id : STR
  ---
  stix_id : STR
  name : STR
  description_en: STR
  description_jp: STR
  url: STR
  created : DATE
  last_modified : DATE
  domein: STR
  version: STR
  order: INTEGER
}

entity TacticOrders {
  * tactic_id: STR
  ---
  order:  INTEGER
}


entity tac_tech {
  * id : INTEGER
  ---
  tactic_id: STR
  technique_id:  STR
}

entity techniques {
  * technique_id : STR
  ---
  stix_id : STR
  name : STR
  description_en: STR
  description_jp: STR
  url: STR
  created : DATE
  last_modified : DATE
  domain: STR
  version: STR
  detection: STR
  is_sub_technique: BOOL
  parent_technique: STR
}

entity tech_data {
  * id : INTEGER
  ---
  datasource_id: STR
  technique_id:  STR
}

entity datasources {
  * datasource_id : STR
  ---
  datasource : STR
  stix_id : STR
  description_en: STR
  description_jp: STR
  platform: STR
  created : DATE
  last_modified : DATE
  version: STR
  type: STR
  url: STR
}

entity collection {
  * layer_id : STR
  ---
  collectionlayer : STR
  description_en: STR
  description_jp: STR
}

entity data_collection {
  * id : INTEGER
  ---
  layer_id: STR
  datasource_id:  STR
}

tactics ||--o{ tac_tech
tactics ||--|| TacticOrders

techniques ||--o{ tac_tech
techniques ||--o{ tech_data
datasources ||--o{ tech_data

datasources ||--o{ data_collection

' techniques || 

@enduml
